<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>City of Syndicates | Neon City RPG</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --neon-pink: #ff00ff;
      --neon-cyan: #00ffff;
      --neon-green: #00ff41;
      --neon-red: #ff0040;
      --neon-yellow: #ffff00;
      --neon-purple: #bf00ff;
      --dark-bg: #0a0a0f;
      --panel-bg: rgba(20, 20, 30, 0.9);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Rajdhani', monospace;
      background: var(--dark-bg);
      color: #e0e0e0;
      min-height: 100vh;
      background-image: 
        linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }
    .grid-overlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      background: linear-gradient(180deg, transparent 0%, rgba(0, 255, 255, 0.05) 50%, transparent 100%);
      animation: scanline 8s linear infinite;
      z-index: -1;
    }
    @keyframes scanline {
      0% { transform: translateY(-100%); }
      100% { transform: translateY(100%); }
    }
    .header {
      text-align: center;
      padding: 20px;
      border-bottom: 2px solid var(--neon-cyan);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.8);
    }
    .header h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 2rem;
      text-transform: uppercase;
      letter-spacing: 4px;
      background: linear-gradient(45deg, var(--neon-cyan), var(--neon-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .tab-banner {
      width: 100%;
      height: 150px;
      background-size: cover;
      background-position: center;
      border-bottom: 2px solid var(--neon-cyan);
    }
    .banner-dashboard { background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1480714378408-67cf0d13bc1b?w=800'); }
    .banner-crimes { background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1519501025264-65ba15a82390?w=800'); }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 10px;
    }
    .panel {
      background: var(--panel-bg);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .panel-title {
      font-family: 'Orbitron', sans-serif;
      color: var(--neon-cyan);
      font-size: 1rem;
      margin-bottom: 10px;
      text-transform: uppercase;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .stat-box {
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(0, 255, 255, 0.2);
      padding: 10px;
      border-radius: 5px;
      text-align: center;
    }
    .stat-value {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--neon-cyan);
      font-family: 'Orbitron', sans-serif;
    }
    .stat-value.money { color: var(--neon-yellow); }
    .btn {
      width: 100%;
      padding: 12px;
      margin: 5px 0;
      border: none;
      border-radius: 5px;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      color: #fff;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }
    .btn.primary {
      background: linear-gradient(135deg, var(--neon-cyan), #0080ff);
    }
    .btn.danger {
      background: linear-gradient(135deg, var(--neon-red), #ff4080);
    }
    .activity-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .activity-card {
      background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 10px;
      padding: 15px;
    }
    .tabs {
      display: flex;
      overflow-x: auto;
      gap: 5px;
      padding: 10px;
      background: rgba(0, 0, 0, 0.5);
    }
    .tab {
      padding: 10px 15px;
      background: transparent;
      border: 1px solid transparent;
      color: #888;
      white-space: nowrap;
    }
    .tab.active {
      color: var(--neon-cyan);
      border-color: var(--neon-cyan);
    }
    .login-screen {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: var(--dark-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .login-box {
      width: 90%;
      max-width: 400px;
      padding: 30px;
      background: var(--panel-bg);
      border: 1px solid var(--neon-cyan);
      border-radius: 10px;
    }
    input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(0, 255, 255, 0.3);
      color: #fff;
      border-radius: 5px;
    }
    .console {
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 5px;
      padding: 10px;
      min-height: 150px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 0.8rem;
    }
  </style>
</head>
<body>
  <div class="grid-overlay"></div>
  <div id="loginScreen" class="login-screen">
    <div class="login-box">
      <h2 style="text-align: center; color: var(--neon-cyan); margin-bottom: 20px;">ğŸ” CITY ACCESS</h2>
      <input type="text" id="loginUser" placeholder="Username">
      <input type="password" id="loginPass" placeholder="Password">
      <button class="btn primary" onclick="login()">ACCESS CITY</button>
      <button class="btn" onclick="register()">CREATE IDENTITY</button>
    </div>
  </div>
  <div id="gameUI" style="display: none;">
    <header class="header">
      <h1>ğŸ™ï¸ CITY OF SYNDICATES</h1>
    </header>
    <div class="tabs">
      <button class="tab active" onclick="showTab('dashboard')">Dashboard</button>
      <button class="tab" onclick="showTab('crimes')">Crimes</button>
      <button class="tab" onclick="showTab('jobs')">Jobs</button>
      <button class="tab" onclick="showTab('market')">Market</button>
      <button class="tab" onclick="showTab('stocks')">Stocks</button>
      <button class="tab" onclick="showTab('pvp')">PvP</button>
    </div>
    <div id="tabBanner" class="tab-banner banner-dashboard"></div>
    <div class="container">
      <div id="tab-dashboard" class="tab-content" style="display: block;">
        <div class="panel">
          <div class="panel-title">ğŸ“Š STATUS</div>
          <div class="stats-grid">
            <div class="stat-box">
              <div>Level</div>
              <div class="stat-value" id="statLevel">1</div>
            </div>
            <div class="stat-box">
              <div>Money</div>
              <div class="stat-value money" id="statMoney">$0</div>
            </div>
            <div class="stat-box">
              <div>Energy</div>
              <div class="stat-value" id="statEnergy">100/100</div>
            </div>
            <div class="stat-box">
              <div>Heat</div>
              <div class="stat-value" id="statHeat">0</div>
            </div>
          </div>
        </div>
        <div class="panel">
          <div class="panel-title">âš¡ QUICK ACTIONS</div>
          <button class="btn" onclick="doCrime()">ğŸ¯ COMMIT CRIME</button>
          <button class="btn" onclick="doJob()">ğŸ’¼ WORK JOB</button>
          <button class="btn" onclick="rest()">ğŸ˜´ REST</button>
        </div>
      </div>
      <div id="tab-crimes" class="tab-content" style="display: none;">
        <div class="panel">
          <div class="panel-title">ğŸ¯ CRIMES</div>
          <div id="crimesList"></div>
        </div>
      </div>
      <div id="tab-jobs" class="tab-content" style="display: none;">
        <div class="panel">
          <div class="panel-title">ğŸ’¼ JOBS</div>
          <div id="jobsList"></div>
        </div>
      </div>
      <div id="tab-market" class="tab-content" style="display: none;">
        <div class="panel">
          <div class="panel-title">ğŸ’Š BLACK MARKET</div>
          <div id="marketList"></div>
        </div>
      </div>
      <div id="tab-stocks" class="tab-content" style="display: none;">
        <div class="panel">
          <div class="panel-title">ğŸ“ˆ STOCKS</div>
          <div id="stockList"></div>
        </div>
      </div>
      <div id="tab-pvp" class="tab-content" style="display: none;">
        <div class="panel">
          <div class="panel-title">âš”ï¸ PvP ARENA</div>
          <div style="text-align: center; padding: 40px;">
            <div style="font-size: 4rem; margin-bottom: 20px;">ğŸ¥· VS ğŸ‘¹</div>
            <button class="btn primary" onclick="joinPvp()">JOIN BATTLE</button>
          </div>
        </div>
      </div>
      <div class="panel">
        <div class="panel-title">ğŸ“Ÿ LOG</div>
        <div class="console" id="gameLog">Welcome to City of Syndicates...</div>
      </div>
    </div>
  </div>
  <script>
        const API = "https://city-of-syndicates-1.onrender.com";
    
    const CRIMES = [
      {id: "pickpocket", name: "Pickpocket", energy: 10, reward: [20, 50], exp: 5, heat: 2, icon: "ğŸ‘‹"},
      {id: "mugging", name: "Mugging", energy: 20, reward: [60, 140], exp: 12, heat: 5, icon: "ğŸ”ª"},
      {id: "warehouse", name: "Warehouse Hit", energy: 35, reward: [150, 320], exp: 25, heat: 10, icon: "ğŸ­"},
      {id: "bank", name: "Bank Heist", energy: 60, reward: [500, 1000], exp: 50, heat: 18, icon: "ğŸ¦"},
      {id: "cyber", name: "Cyber Intrusion", energy: 25, reward: [200, 450], exp: 30, heat: 8, icon: "ğŸ’»"},
      {id: "extortion", name: "Extortion", energy: 30, reward: [300, 600], exp: 35, heat: 12, icon: "ğŸ’€"},
      {id: "smuggling", name: "Smuggling", energy: 45, reward: [400, 800], exp: 40, heat: 15, icon: "ğŸšš"},
      {id: "hit", name: "Wetwork", energy: 80, reward: [1000, 2000], exp: 80, heat: 25, icon: "ğŸ¯"}
    ];
    
    const JOBS = [
      {id: "courier", name: "Courier", energy: 10, payout: [25, 60], exp: 4, icon: "ğŸ“¦"},
      {id: "bouncer", name: "Bouncer", energy: 18, payout: [60, 140], exp: 10, icon: "ğŸ’ª"},
      {id: "bartender", name: "Bartender", energy: 15, payout: [50, 110], exp: 8, icon: "ğŸ¸"},
      {id: "vip", name: "VIP Host", energy: 25, payout: [120, 260], exp: 18, icon: "ğŸ©"},
      {id: "mechanic", name: "Mechanic", energy: 20, payout: [80, 180], exp: 12, icon: "ğŸ”§"},
      {id: "hacker", name: "IT Consultant", energy: 22, payout: [150, 320], exp: 20, icon: "ğŸ’»"},
      {id: "security", name: "Security Guard", energy: 28, payout: [100, 220], exp: 15, icon: "ğŸ›¡ï¸"},
      {id: "driver", name: "Chauffeur", energy: 16, payout: [70, 150], exp: 10, icon: "ğŸš—"},
      {id: "cook", name: "Line Cook", energy: 20, payout: [60, 130], exp: 8, icon: "ğŸ³"},
      {id: "dealer", name: "Card Dealer", energy: 24, payout: [140, 300], exp: 16, icon: "ğŸƒ"},
      {id: "trainer", name: "Gym Trainer", energy: 30, payout: [180, 380], exp: 22, icon: "ğŸ‹ï¸"},
      {id: "fixer", name: "Corporate Fixer", energy: 35, payout: [250, 500], exp: 28, icon: "ğŸ•´ï¸"}
    ];
    
    const DRUGS = [
      {id: "weed", name: "Neon Green", buy: 50, sell: 80, icon: "ğŸŒ¿"},
      {id: "coke", name: "White Lightning", buy: 200, sell: 350, icon: "â„ï¸"},
      {id: "heroin", name: "Black Tar", buy: 400, sell: 700, icon: "ğŸ–¤"},
      {id: "meth", name: "Crystal Blue", buy: 300, sell: 550, icon: "ğŸ’"},
      {id: "lsd", name: "Neon Dreams", buy: 150, sell: 280, icon: "ğŸŒˆ"},
      {id: "mdma", name: "Love Bomb", buy: 180, sell: 320, icon: "ğŸ’Š"},
      {id: "roids", name: "Synthol", buy: 250, sell: 450, icon: "ğŸ’‰"},
      {id: "adrenaline", name: "Adrenaline Shot", buy: 500, sell: 900, icon: "ğŸ’‰"}
    ];
    
    const STOCKS = [
      {sym: "NEON", name: "Neon Corp", price: 150},
      {sym: "SYND", name: "Syndicate Holdings", price: 85},
      {sym: "CYBR", name: "CyberDyne", price: 220},
      {sym: "PHAR", name: "PharmaTek", price: 95},
      {sym: "ARMS", name: "Armstrong Weapons", price: 180},
      {sym: "SECU", name: "SecureNet", price: 120},
      {sym: "BIO", name: "BioSynth", price: 200},
      {sym: "ENER", name: "EnerCore", price: 140}
    ];
    
    let player = null;
    let token = null;
    let stockPrices = {};
    
    function log(msg) {
      const el = document.getElementById('gameLog');
      el.innerHTML += `<div>> ${msg}</div>`;
      el.scrollTop = el.scrollHeight;
    }
    
    async function api(path, method="GET", body=null) {
      try {
        const opts = {
          method: method,
          headers: {"Content-Type": "application/json"}
        };
        if (token) opts.headers["Authorization"] = "Bearer " + token;
        if (body) opts.body = JSON.stringify(body);
        const r = await fetch(API + path, opts);
        return await r.json();
      } catch(e) {
        log("Error: " + e.message);
        return {error: e.message};
      }
    }
    
    async function register() {
      const u = document.getElementById('loginUser').value;
      const p = document.getElementById('loginPass').value;
      if (!u || !p) return log("Enter credentials");
      const data = await api("/register", "POST", {username: u, password: p});
      if (data.error) log(data.error);
      else log("Registered! Now login.");
    }
    
    async function login() {
      const u = document.getElementById('loginUser').value;
      const p = document.getElementById('loginPass').value;
      if (!u || !p) return log("Enter credentials");
      
      const form = new URLSearchParams();
      form.append('username', u);
      form.append('password', p);
      
      const r = await fetch(API + '/token', {
        method: 'POST',
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: form
      });
      const data = await r.json();
      
      if (data.access_token) {
        token = data.access_token;
        player = u;
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('gameUI').style.display = 'block';
        log("Connected as " + u);
        updateStats();
        renderCrimes();
        renderJobs();
        renderMarket();
        renderStocks();
        startStocks();
      } else {
        log("Login failed");
      }
    }
    
    function showTab(tab) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
      document.getElementById('tab-' + tab).style.display = 'block';
      document.getElementById('tabBanner').className = 'tab-banner banner-' + tab;
    }
    
    async function updateStats() {
      const data = await api('/me');
      if (data.username) {
        document.getElementById('statLevel').textContent = data.level;
        document.getElementById('statMoney').textContent = '$' + Math.floor(data.money);
        document.getElementById('statEnergy').textContent = data.energy + '/' + data.max_energy;
        document.getElementById('statHeat').textContent = data.heat;
      }
    }
    
    function renderCrimes() {
      const div = document.getElementById('crimesList');
      div.innerHTML = CRIMES.map(c => `
        <div class="activity-card" onclick="commitCrime('${c.id}')" style="margin-bottom: 10px;">
          <div style="font-size: 1.2rem; font-weight: bold;">${c.icon} ${c.name}</div>
          <div style="color: #888; font-size: 0.9rem;">
            âš¡ ${c.energy} | ğŸ’° $${c.reward[0]}-${c.reward[1]} | ğŸ”¥ ${c.heat}
          </div>
        </div>
      `).join('');
    }
    
    function renderJobs() {
      const div = document.getElementById('jobsList');
      div.innerHTML = JOBS.map(j => `
        <div class="activity-card" onclick="doJob('${j.id}')" style="margin-bottom: 10px;">
          <div style="font-size: 1.2rem; font-weight: bold;">${j.icon} ${j.name}</div>
          <div style="color: #888; font-size: 0.9rem;">
            âš¡ ${j.energy} | ğŸ’° $${j.payout[0]}-${j.payout[1]}
          </div>
        </div>
      `).join('');
    }
    
    function renderMarket() {
      const div = document.getElementById('marketList');
      div.innerHTML = DRUGS.map(d => `
        <div class="activity-card" style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
          <div>
            <div style="font-size: 1.2rem; font-weight: bold;">${d.icon} ${d.name}</div>
            <div style="color: #888; font-size: 0.8rem;">Buy: $${d.buy} | Sell: $${d.sell}</div>
          </div>
          <div>
            <button class="btn" style="width: auto; padding: 8px 15px; margin: 0 5px;" onclick="buyDrug('${d.id}')">BUY</button>
            <button class="btn" style="width: auto; padding: 8px 15px; margin: 0;" onclick="sellDrug('${d.id}')">SELL</button>
          </div>
        </div>
      `).join('');
    }
    
    function renderStocks() {
      const div = document.getElementById('stockList');
      div.innerHTML = STOCKS.map(s => {
        const price = stockPrices[s.sym] || s.price;
        return `
        <div class="activity-card" style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
          <div>
            <div style="font-size: 1.2rem; font-weight: bold; color: var(--neon-green);">${s.sym}</div>
            <div style="color: #888; font-size: 0.8rem;">${s.name}</div>
          </div>
          <div style="text-align: right;">
            <div style="font-size: 1.3rem; font-weight: bold;">$${price.toFixed(2)}</div>
            <button class="btn" style="width: auto; padding: 8px 15px; margin: 5px 0;" onclick="buyStock('${s.sym}')">BUY</button>
          </div>
        </div>
      `}).join('');
    }
    
    async function commitCrime(id) {
      const crime = CRIMES.find(c => c.id === id);
      const data = await api('/crime', 'POST', {crime_id: id});
      if (data.success) {
        const reward = Math.floor(Math.random() * (crime.reward[1] - crime.reward[0])) + crime.reward[0];
        log(`âœ… ${crime.name} successful! +$${reward}`);
      } else {
        log(`âŒ ${crime.name} failed!`);
      }
      updateStats();
    }
    
    async function doJob(id) {
      const job = JOBS.find(j => j.id === id);
      const data = await api('/job', 'POST', {job_id: id});
      const payout = Math.floor(Math.random() * (job.payout[1] - job.payout[0])) + job.payout[0];
      log(`âœ… Worked as ${job.name}. +$${payout}`);
      updateStats();
    }
    
    async function rest() {
      const data = await api('/rest', 'POST');
      log(`ğŸ˜´ Rested. Energy restored.`);
      updateStats();
    }
    
    function buyDrug(id) {
      const drug = DRUGS.find(d => d.id === id);
      log(`ğŸ’Š Bought ${drug.name} for $${drug.buy}`);
    }
    
    function sellDrug(id) {
      const drug = DRUGS.find(d => d.id === id);
      log(`ğŸ’Š Sold ${drug.name} for $${drug.sell}`);
    }
    
    function startStocks() {
      STOCKS.forEach(s => stockPrices[s.sym] = s.price);
      setInterval(() => {
        STOCKS.forEach(s => {
          const change = (Math.random() - 0.5) * 0.1;
          stockPrices[s.sym] = Math.max(1, stockPrices[s.sym] * (1 + change));
        });
        renderStocks();
      }, 5000);
    }
    
    function buyStock(sym) {
      const price = stockPrices[sym];
      log(`ğŸ“ˆ Bought 1 share of ${sym} at $${price.toFixed(2)}`);
    }
    
    function joinPvp() {
      log(`âš”ï¸ Joining PvP queue...`);
      setTimeout(() => {
        log(`âš”ï¸ Match found! Battle starting...`);
      }, 2000);
    }
    
    setInterval(() => {
      if (token) updateStats();
    }, 30000);
  </script>
</body>
</html>
